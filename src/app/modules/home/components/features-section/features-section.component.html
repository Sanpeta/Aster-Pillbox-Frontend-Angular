<section
	id="features"
	class="features-section"
	aria-labelledby="features-title"
>
	<div class="features-container">
		<!-- Header da Seção -->
		<div class="features-header">
			<span class="features-badge">TECNOLOGIA AVANÇADA</span>
			<h2 id="features-title" class="features-title">
				Recursos que Revolucionam o Cuidado com a Saúde
			</h2>
			<p class="features-description">
				Nossa plataforma combina IoT, inteligência artificial e medicina
				de precisão para ofertar uma experiência única de gestão de
				medicamentos e saúde.
			</p>
		</div>

		<!-- Métricas de Impacto -->
		<div
			*ngIf="healthMetrics.length > 0"
			@fadeInScale
			class="health-metrics"
		>
			<div *ngFor="let metric of healthMetrics" class="metric-card">
				<div class="metric-icon">
					<svg
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						viewBox="0 0 24 24"
						aria-hidden="true"
					>
						<path
							stroke-linecap="round"
							stroke-linejoin="round"
							[attr.d]="metric.icon"
						></path>
					</svg>
				</div>
				<div class="metric-content">
					<div class="metric-value">
						{{ metric.value }}
						<span
							class="metric-trend"
							[class.trend-up]="metric.trend === 'up'"
							[class.trend-down]="metric.trend === 'down'"
							[class.trend-stable]="metric.trend === 'stable'"
							[attr.aria-label]="'Tendência: ' + metric.trend"
						>
							<svg
								*ngIf="metric.trend === 'up'"
								width="12"
								height="12"
								fill="currentColor"
								viewBox="0 0 16 16"
							>
								<path
									d="M8 0a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L9 3.414V13a1 1 0 11-2 0V3.414L5.707 4.707a1 1 0 11-1.414-1.414l3-3A1 1 0 018 0z"
								/>
							</svg>
							<svg
								*ngIf="metric.trend === 'down'"
								width="12"
								height="12"
								fill="currentColor"
								viewBox="0 0 16 16"
							>
								<path
									d="M8 16a1 1 0 01-.707-.293l-3-3a1 1 0 111.414-1.414L7 12.586V3a1 1 0 112 0v9.586l1.293-1.293a1 1 0 111.414 1.414l-3 3A1 1 0 018 16z"
								/>
							</svg>
							<svg
								*ngIf="metric.trend === 'stable'"
								width="12"
								height="12"
								fill="currentColor"
								viewBox="0 0 16 16"
							>
								<path
									d="M1 8a1 1 0 011-1h12a1 1 0 110 2H2a1 1 0 01-1-1z"
								/>
							</svg>
						</span>
					</div>
					<div class="metric-name">{{ metric.name }}</div>
				</div>
			</div>
		</div>

		<!-- Estado de Loading -->
		<div
			*ngIf="isLoading"
			class="features-loading"
			role="status"
			aria-label="Carregando funcionalidades"
		>
			<div class="loading-spinner"></div>
			<span class="visually-hidden">Carregando funcionalidades...</span>
		</div>

		<!-- Controle de Visualização -->
		<div *ngIf="!isLoading" class="features-controls">
			<button
				(click)="toggleAdvancedFeatures()"
				class="toggle-advanced-btn"
				[class.active]="showAdvancedFeatures"
				type="button"
				[attr.aria-label]="
					showAdvancedFeatures
						? 'Ocultar recursos profissionais'
						: 'Mostrar todos os recursos'
				"
			>
				<span class="toggle-text">
					{{
						showAdvancedFeatures
							? "Recursos Essenciais"
							: "Ver Todos os Recursos"
					}}
				</span>
				<svg
					class="toggle-icon"
					[class.rotated]="showAdvancedFeatures"
					fill="none"
					stroke="currentColor"
					stroke-width="2"
					viewBox="0 0 24 24"
					aria-hidden="true"
				>
					<path
						stroke-linecap="round"
						stroke-linejoin="round"
						d="M19 9l-7 7-7-7"
					/>
				</svg>
			</button>
		</div>

		<!-- Grid de Funcionalidades -->
		<div
			*ngIf="!isLoading"
			@staggerAnimation
			class="features-grid"
			role="list"
		>
			<article
				*ngFor="
					let feature of getFilteredFeatures();
					index as i;
					trackBy: trackByFn
				"
				class="feature-card"
				[class.premium-feature]="feature.requiresPremium"
				[attr.data-complexity]="feature.complexity"
				role="listitem"
				[attr.aria-label]="feature.ariaLabel || feature.title"
			>
				<!-- Header do Card -->
				<div class="feature-card-header">
					<div class="feature-icon-container">
						<svg
							class="feature-icon"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							viewBox="0 0 24 24"
							[attr.aria-hidden]="true"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								[attr.d]="getIconPath(feature.icon)"
							></path>
						</svg>
					</div>

					<div class="feature-metadata">
						<span
							class="complexity-badge"
							[ngClass]="getComplexityColor(feature.complexity)"
						>
							{{ getComplexityLabel(feature.complexity) }}
						</span>
						<span
							*ngIf="feature.requiresPremium"
							class="premium-badge"
							aria-label="Recurso premium"
						>
							<svg
								width="12"
								height="12"
								fill="currentColor"
								viewBox="0 0 16 16"
							>
								<path
									d="M8 0l2.5 5h5.5l-4.5 3.5 1.5 5.5L8 10.5 3.5 14l1.5-5.5L0 5h5.5L8 0z"
								/>
							</svg>
							Premium
						</span>
					</div>
				</div>

				<!-- Conteúdo do Card -->
				<div class="feature-card-content">
					<h3 class="feature-title">{{ feature.title }}</h3>

					<p class="feature-description">{{ feature.description }}</p>

					<!-- Lista de Benefícios -->
					<ul class="feature-benefits" role="list">
						<li
							*ngFor="let benefit of feature.benefits"
							class="benefit-item"
							role="listitem"
						>
							<svg
								class="benefit-icon"
								fill="currentColor"
								viewBox="0 0 20 20"
								aria-hidden="true"
							>
								<path
									fill-rule="evenodd"
									d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
									clip-rule="evenodd"
								/>
							</svg>
							<span>{{ benefit }}</span>
						</li>
					</ul>
				</div>

				<!-- Footer do Card -->
				<div class="feature-card-footer">
					<div class="feature-actions">
						<button
							(click)="
								handleActionClick(
									feature.primaryAction,
									feature
								)
							"
							class="feature-btn feature-btn-primary"
							type="button"
							[attr.aria-label]="
								'Executar ação principal para ' + feature.title
							"
						>
							{{ feature.primaryAction }}
						</button>
						<button
							(click)="
								handleActionClick(
									feature.secondaryAction,
									feature
								)
							"
							class="feature-btn feature-btn-secondary"
							type="button"
							[attr.aria-label]="
								'Executar ação secundária para ' + feature.title
							"
						>
							{{ feature.secondaryAction }}
						</button>
					</div>
				</div>
			</article>
		</div>

		<!-- Seção CTA Melhorada -->
		<div class="features-cta" @fadeInScale>
			<div class="cta-background">
				<div class="cta-pattern"></div>
			</div>
			<div class="cta-content">
				<div class="cta-info">
					<div class="cta-icon-container">
						<svg
							class="cta-icon"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							viewBox="0 0 24 24"
							aria-hidden="true"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								d="M13 10V3L4 14h7v7l9-11h-7z"
							/>
						</svg>
					</div>
					<div class="cta-text">
						<h3>Pronto para Transformar sua Rotina de Saúde?</h3>
						<p>
							Junte-se a milhares de famílias que já descobriram
							uma forma mais inteligente de cuidar da medicação
						</p>
					</div>
				</div>
				<div class="cta-buttons">
					<button
						class="cta-button cta-button-primary"
						type="button"
						aria-label="Começar teste gratuito de 7 dias"
					>
						Teste Grátis 7 Dias
						<svg
							class="button-arrow"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							viewBox="0 0 24 24"
							aria-hidden="true"
						>
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								d="M14 5l7 7m0 0l-7 7m7-7H3"
							/>
						</svg>
					</button>
					<button
						class="cta-button cta-button-secondary"
						type="button"
						aria-label="Ver demonstração interativa"
					>
						Ver Demonstração
					</button>
				</div>
			</div>
		</div>
	</div>
</section>
