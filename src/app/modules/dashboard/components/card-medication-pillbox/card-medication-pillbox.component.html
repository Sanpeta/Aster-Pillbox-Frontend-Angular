<div class="pillbox-card">
	<div class="card-header">
		<h2 class="card-title">Caixa de Medicamentos</h2>
		<button
			class="info-button"
			[routerLink]="'/dashboard/pillboxes'"
			routerLinkActive="active"
			aria-label="Editar caixa de medicamentos"
		>
			<app-icon
				[src]="'../../../../../assets/images/info-icon.svg'"
				[alt]="'Editar'"
			></app-icon>
		</button>
	</div>

	<div class="card-content">
		@if (listCase.length > 0) {
		<form class="select-container" [formGroup]="selectForm">
			<label for="pillbox-select" class="select-label">
				Selecionar caixa
			</label>
			<select
				id="pillbox-select"
				class="select-input"
				formControlName="pillbox"
				name="pillbox"
				required
			>
				<option value="" disabled>
					Selecione a Caixa de Medicamento
				</option>
				@for (pillbox of listCase; track $index) {
				<option [value]="$index">
					{{ pillbox.case_name }}
				</option>
				}
			</select>
		</form>

		<!-- Grid da Caixa de Medicamentos -->
		@if (columns > 0 && rows > 0) {
		<div
			class="pills-grid"
			[style.grid-template-columns]="'repeat(' + columns + ', 1fr)'"
			[style.grid-template-rows]="'repeat(' + rows + ', 1fr)'"
		>
			@for (index of createRange(rows * columns); track $index) {
			<div
				class="pill-slot"
				[class.occupied]="index + 1 <= 5"
				[attr.aria-label]="'Compartimento ' + (index + 1)"
				tabindex="0"
				role="button"
			>
				{{ index + 1 }}
			</div>
			}
		</div>
		} @else {
		<div class="grid-placeholder">
			<p class="placeholder-text">
				Selecione uma caixa para visualizar os compartimentos
			</p>
		</div>
		} } @else {
		<div class="empty-state">
			<svg
				class="empty-icon"
				xmlns="http://www.w3.org/2000/svg"
				fill="none"
				viewBox="0 0 24 24"
				stroke="currentColor"
			>
				<path
					stroke-linecap="round"
					stroke-linejoin="round"
					stroke-width="2"
					d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"
				/>
			</svg>
			<p class="empty-message">Nenhuma caixa de medicamento cadastrada</p>
			<button
				class="add-pillbox-button"
				[routerLink]="'/dashboard/pillboxes'"
				routerLinkActive="active"
			>
				Cadastrar Nova Caixa
			</button>
		</div>
		}
	</div>
</div>
